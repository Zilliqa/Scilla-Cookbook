<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Metatransactions | Scilla Cookbook</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://scilla-cookbook.org/img/site/meta.jpg?v=1"><meta data-react-helmet="true" name="twitter:image" content="https://scilla-cookbook.org/img/site/meta.jpg?v=1"><meta data-react-helmet="true" property="og:url" content="https://scilla-cookbook.org/recipes/scilla-contract/metatransactions"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Metatransactions | Scilla Cookbook"><meta data-react-helmet="true" name="description" content="Meta Transactions are a broad concept borrowed from Ethereum where it is typically used to load authenticated data onto a smart contract. This pattern is needed for many Ethereum projects including the â€˜gaslessâ€™ relay system whereby one or more nodes accept transactions signed with a hidden private key and then wrap that transaction in a Ethereum transaction."><meta data-react-helmet="true" property="og:description" content="Meta Transactions are a broad concept borrowed from Ethereum where it is typically used to load authenticated data onto a smart contract. This pattern is needed for many Ethereum projects including the â€˜gaslessâ€™ relay system whereby one or more nodes accept transactions signed with a hidden private key and then wrap that transaction in a Ethereum transaction."><link data-react-helmet="true" rel="shortcut icon" href="/img/site/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://scilla-cookbook.org/recipes/scilla-contract/metatransactions"><link data-react-helmet="true" rel="alternate" href="https://scilla-cookbook.org/recipes/scilla-contract/metatransactions" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://scilla-cookbook.org/recipes/scilla-contract/metatransactions" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3db205b2.css">
<link rel="preload" href="/assets/js/runtime~main.f82fbd24.js" as="script">
<link rel="preload" href="/assets/js/main.af6abdb7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/site/scilla-200.png" alt="Community Scilla Cookbook" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/site/scilla-200.png" alt="Community Scilla Cookbook" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Community Scilla Cookbook</b></a><a href="https://discord.gg/nKznfCaZxy" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://t.me/ZilliqaDevs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://scilla.readthedocs.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Scilla Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://ide.zilliqa.com/#/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Scilla IDE<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/Zilliqa/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Zilliqa/Scilla-by-Example" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Community Cookbook Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/">Community Scilla Cookbook</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Recipes</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Scilla Contracts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/addresses">Addresses</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/adt">Algebraic Data Types</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/bnum">BNum</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/bool">Boolean</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/dex">Decentralised Exchange (DEX)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/folding">Recursion</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/functions">Functions</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/funds">Funds</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/fungible">Fungible Token</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/imports">Imports</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/keywords">Glossary of Keywords &amp; Conventions</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/list">List</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/map">Maps</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/messages">Messages, Callbacks &amp; Contract-to-Contract Interaction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/recipes/scilla-contract/metatransactions">Metatransactions</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/mutisignature">Muti-signature contracts</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/natural">Natural Numbers</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/nonfungible">Non-Fungible Token (NFT)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/notable-contracts">Notable Contracts</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/option">Option</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/pair">Pair</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/pattern_ownership">Pattern (Ownership)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/pattern_proxy">Pattern (Proxy)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/pattern_pushvspush">Pattern (Push vs Pull)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/pattern_view">Pattern (Viewer)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/random">True Random VS Pseudo-Random</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/remoteread">Remote State Reads (RSR)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/safemutiply">Safe Mutiplication</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/recipes/scilla-contract/uint">U/int</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Contract Interaction</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Side-dishes</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorials</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Metatransactions</h1></header><p>Meta Transactions are a broad concept borrowed from Ethereum where it is typically used to load authenticated data onto a smart contract. This pattern is needed for many Ethereum projects including the â€˜gaslessâ€™ relay system whereby one or more nodes accept transactions signed with a hidden private key and then wrap that transaction in a Ethereum transaction.</p><p><a href="https://github.com/Zilliqa/ZRC/blob/master/zrcs/zrc-3.md" target="_blank" rel="noopener noreferrer">ZRC-3</a> defines the technical specification that another contract with the ability to perform transitions with metatransactions should consume.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="how-does-it-work"></a>How does it work?<a class="hash-link" href="#how-does-it-work" title="Direct link to heading">#</a></h2><p>Itâ€™s equivalent to adding a checkbook to your bank account (contract). Through the metatransaction which is defined by all the variables to show proof that the owner of the funds did authorize this exact spend in the form of a cryptographic signature of the entire message hash.</p><p>Metatransactions provide an alternative flow for users just getting started with their cryptocurrency and wallets. It allows for gasless transactions, cutting out the barrier of getting ZIL from an exchange or via mining before a Dapp user can interact with the smart contract.</p><p>It can also be seen as a way to defer the processing of transactions or even to guard a transition that requires multiparty authorization, although those applications are left to implementations and future standards.</p><p><a href="https://github.com/Zilliqa/ZRC/blob/master/reference/MetaFungibleToken.scilla" target="_blank" rel="noopener noreferrer">The ZRC-3 contract</a> adds a metatransfer transition to the existing ZRC-2 interface.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="docker-interaction"></a>Docker Interaction<a class="hash-link" href="#docker-interaction" title="Direct link to heading">#</a></h2><p><a href="https://github.com/starling-foundries/relay.js" target="_blank" rel="noopener noreferrer">relay.js</a> is a repository containing the cheque relay to forward metatransactions to zilliqa network (sometimes called a bouncer proxy).</p><p>This contract is based largely on the recommendations of EIP-965. It accomplishes similar goals, but also adds a functionality for gasless metatransactions. In this implementation the cheque is a message containing these parameters:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly JS"><pre tabindex="0" class="prism-code language-JS codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         &quot;from&quot; : &quot;0xa0000000...&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">           &quot;to&quot; : &quot;0xb0000000...&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">       &quot;amount&quot; : 100,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;contract&quot; : &quot;0x12395345...&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;fee&quot; : 2,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;nonce&quot; : 12,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;signature&quot; : &quot;0xasdlj3io2j...&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;pubkey&quot;    : &quot;asdfg123...&quot; </span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note that the recipient, amount, contract, fee and nonce values are hashed and signed client-side before submitting the metatransaction to an arbotarily relay which can use this metatransaction as a spend-by-proxy. Both the relay and sender can be confident that parameters are properly validated on-chain, only a valid metatransaction can be spent and it can only be spent once.</p><p>This spend function does not replace the normal Transfer transition or the OperatorSend functionality already possible with ZRC2, instead it offers a third method for authorizing these transfers. One in which the holder of a token with spending authority is not presumed to have the Zil onhand to pay for transactions. It also optionally allows for paying transaction fees in tokens.</p><p>Posession of a metatransaction authorizes a relayer to submit this cheque on their behalf. This does not guarantee the funds, as any other transactions spending funds will be ordered like any other within the blockchain. This is by design as it removes the main way relays can abuse power - by censoring transactions.</p><p>If a relayer does not submit the cheque in a timely manner, the token holder has the opportunity to send the same metatransaction to the voidcheque transition to ensure the stalled transaction is not processed later.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="relayer-responsibilities"></a>Relayer responsibilities<a class="hash-link" href="#relayer-responsibilities" title="Direct link to heading">#</a></h3><p>The relayer provides a public endpoint for recieving metatransactions, chequeing it&#x27;s target contract and can validate any parameters to avoid wasting its own gas with a transaction that might be refused due to balance or previous spending of the metatransaction.</p><p>It may optionally report a minimum fee, but it cannot charge a fee that the token owner did not approve in the signed metatransaction. The anticipated malevolent behavior - a relayer censoring transactions - is mitigated by the possibility for multiple relayers.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="further-reading"></a>Further Reading<a class="hash-link" href="#further-reading" title="Direct link to heading">#</a></h2><p><a href="https://medium.com/builders-of-zilliqa/zrc3s-grand-rewrite-22558797ea0" target="_blank" rel="noopener noreferrer">Medium - ZRC3â€™s Grand Rewrite</a></p><p><a href="https://github.com/Zilliqa/ZRC/blob/master/zrcs/zrc-3.md" target="_blank" rel="noopener noreferrer">ZRC-3 Specification</a></p><p><a href="https://github.com/Zilliqa/ZRC/blob/master/reference/MetaFungibleToken.scilla" target="_blank" rel="noopener noreferrer">ZRC-3 - Contract</a></p><p><a href="https://github.com/Zilliqa/ZRC/tree/master/example/zrc3" target="_blank" rel="noopener noreferrer">ZRC3 - Interaction</a></p><p><a href="https://github.com/starling-foundries/relay.js" target="_blank" rel="noopener noreferrer">relay.js &quot;bouncer proxy&quot; - Docker Interaction</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/metatransaction">metatransaction</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/reference">reference</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/contract">contract</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/zrc-3">zrc-3</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Zilliqa/Scilla-Cookbook/tree/master/docs/recipes/scilla-contract/metatransactions.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/recipes/scilla-contract/messages"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Messages, Callbacks &amp; Contract-to-Contract Interaction</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/recipes/scilla-contract/mutisignature"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Muti-signature contracts Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-does-it-work" class="table-of-contents__link">How does it work?</a></li><li><a href="#docker-interaction" class="table-of-contents__link">Docker Interaction</a><ul><li><a href="#relayer-responsibilities" class="table-of-contents__link">Relayer responsibilities</a></li></ul></li><li><a href="#further-reading" class="table-of-contents__link">Further Reading</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.f82fbd24.js"></script>
<script src="/assets/js/main.af6abdb7.js"></script>
</body>
</html>