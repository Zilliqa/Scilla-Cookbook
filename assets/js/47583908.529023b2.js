"use strict";(self.webpackChunkdocu_scilla=self.webpackChunkdocu_scilla||[]).push([[6829],{3905:function(e,n,r){r.d(n,{Zo:function(){return p},kt:function(){return u}});var t=r(7294);function o(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function a(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function i(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?a(Object(r),!0).forEach((function(n){o(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function s(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=t.createContext({}),l=function(e){var n=t.useContext(c),r=n;return e&&(r="function"==typeof e?e(n):i(i({},n),e)),r},p=function(e){var n=l(e.components);return t.createElement(c.Provider,{value:n},e.children)},w={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},h=t.forwardRef((function(e,n){var r=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),h=l(r),u=o,d=h["".concat(c,".").concat(u)]||h[u]||w[u]||a;return r?t.createElement(d,i(i({ref:n},p),{},{components:r})):t.createElement(d,i({ref:n},p))}));function u(e,n){var r=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=h;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=r[l];return t.createElement.apply(null,i)}return t.createElement.apply(null,r)}h.displayName="MDXCreateElement"},7559:function(e,n,r){r.r(n),r.d(n,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return l},toc:function(){return p},default:function(){return h}});var t=r(7462),o=r(3366),a=(r(7294),r(3905)),i=["components"],s={tags:["ownership"]},c="Ownership",l={unversionedId:"recipes/scilla-contract/ownership",id:"recipes/scilla-contract/ownership",isDocsHomePage:!1,title:"Ownership",description:"If your contract has an owner it typically means that address has admin powers meaning they have the privilage to adding/remove critical data or pause/unpause the contract.",source:"@site/docs/recipes/scilla-contract/ownership.md",sourceDirName:"recipes/scilla-contract",slug:"/recipes/scilla-contract/ownership",permalink:"/recipes/scilla-contract/ownership",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/recipes/scilla-contract/ownership.md",tags:[{label:"ownership",permalink:"/tags/ownership"}],version:"current",frontMatter:{tags:["ownership"]},sidebar:"tutorialSidebar",previous:{title:"Option",permalink:"/recipes/scilla-contract/option"},next:{title:"Pair",permalink:"/recipes/scilla-contract/pair"}},p=[{value:"Transfering Ownership",id:"transfering-ownership",children:[]}],w={toc:p};function h(e){var n=e.components,r=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,t.Z)({},w,r,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"ownership"},"Ownership"),(0,a.kt)("p",null,"If your contract has an owner it typically means that address has admin powers meaning they have the privilage to adding/remove critical data or pause/unpause the contract."),(0,a.kt)("p",null,"It's important to keep your address keys safe, but if for any reason a ",(0,a.kt)("inlineCode",{parentName:"p"},"contract_owner")," needs changing, there needs to be transitions pre-baked into your contract to handle this case."),(0,a.kt)("h2",{id:"transfering-ownership"},"Transfering Ownership"),(0,a.kt)("p",null,"Note the below example. The ",(0,a.kt)("inlineCode",{parentName:"p"},"owner")," field is initally set to ",(0,a.kt)("inlineCode",{parentName:"p"},"owner_at_deployment"),", but can then be changed at a later date. You should consider an ownership pattern when writing contracts."),(0,a.kt)("p",null,"It shows three ways of how to change the owner of the contract:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"transition ChangeOwner(new_owner : ByStr20)")),(0,a.kt)("p",null,"ChangeOwner allows anybody to change contract_owner to any address, which is dangerous"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"transition ChangeOwnerByOwnerOnly(new_owner : ByStr20)")),(0,a.kt)("p",null,"Here only the owner can change the ownership. This is better, yet still problematic as the new_owner might be wrong (a typo is enough), and thus the contract will have either a wrong owner, or even worse a non-existing owner."),(0,a.kt)("p",null,"The suggested way of transfering ownership, see Scilla Documentation -- use this in practice.\nThe current owner proposes (stages) a new owner"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"transition RequestOwnershipTransfer(new_owner : ByStr20)")),(0,a.kt)("p",null,"The proposed new owner accepts the ownership"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"transition ConfirmOwnershipTransfer()")),(0,a.kt)("p",null,"This allows a recall of ownership in the case the address was mistyped."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ocaml"},'scilla_version 0\n\ncontract Ownership\n(owner_at_deployment: ByStr20) (* immutable *)\n\n(* mutable fields declarations *)\nfield owner : ByStr20 = owner_at_deployment (* the current owner *)\nfield pending_owner: Option ByStr20 = None {ByStr20} (* a new owner has been proposed *)\n\n(* emit an event showing both the sender and the owner, and a bool if they equal *)\ntransition IsOwnerCalling()\n  o <- owner;\n  is_owner = builtin eq _origin o;\n  ev = {_eventname: "Foo"; origin: _origin; owner: o; called_by_owner: is_owner};\n  event ev\nend\n\n(* change ownership: everyone can do this, not just the actual owner:\n    Should not be done in practice, we just show how to simply update a field *)\ntransition ChangeOwner(new_owner : ByStr20)\n  old <- owner;\n  owner := new_owner;\n  ev = {_eventname: "ChangeOwner"; _origin: _origin; old_owner: old; new_owner: new_owner};\n  event ev\nend\n\n(* change ownership: only owner can do this: Still not optimal as a wrong\n    parameter will lock out the intended new_owner, and give away owner_ship *)\ntransition ChangeOwnerByOwnerOnly(new_owner : ByStr20)\n  old <- owner;\n  is_owner = builtin eq _origin old;\n  match is_owner with\n  | False => (* do not change the owner as _origin is not current owner *)\n    ev = {_eventname: "ChangeOwnerByOwnerOnlyFailure"};\n    event ev\n  | True =>\n    owner := new_owner;\n    ev = {_eventname: "ChangeOwnerByOwnerOnlySuccess"};\n    event ev\n  end\nend\n\n(* the safe way of tranfering owner ship: current owner proposes a new owner    *)\n(* and the new onwer collects/accpets the owner ship                            *)\ntransition RequestOwnershipTransfer(new_owner : ByStr20)\n  current <- owner;\n  is_owner = builtin eq _origin current;\n  match is_owner with\n  | False => (* do not accept proposal as _origin is not current owner *)\n    ev = {_eventname: "RequestOwnershipTransferFailureSameOwner"};\n    event ev\n  | True =>\n    proposed = Some {ByStr20} new_owner;\n    pending_owner := proposed;\n    ev = {_eventname: "RequestOwnershipTransferSuccess"};\n    event ev\n  end\nend\n\ntransition ConfirmOwnershipTransfer()\n  proposed_option <- pending_owner;\n  match proposed_option with\n  | None => (* ownership transfer is not in-progress, do nothing *)\n    ev = {_eventname: "ConfirmOwnershipTransferFailureNoProposedNewOwner"};\n    event ev\n  | Some proposed_owner =>\n    caller_is_new_owner = builtin eq _origin proposed_owner;\n    match caller_is_new_owner with\n    | False => (* the caller is not the new owner, do nothing *)\n      ev = {_eventname: "ConfirmOwnershipTransferFailureNotCalledByProposedNewOwner"};\n      event ev\n    | True => (* transfer ownership *)\n      owner := proposed_owner;\n      none = None {ByStr20};\n      pending_owner := none;\n      ev = {_eventname: "ConfirmOwnershipTransferSuccess"};\n      event ev\n    end\n  end\nend\n\n')))}h.isMDXComponent=!0}}]);